<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <meta name="generator" content="VuePress 2.0.0-beta.62">
    <style>
      :root {
        --c-bg: #fff;
      }
      html.dark {
        --c-bg: #22272e;
      }
      html, body {
        background-color: var(--c-bg);
      }
    </style>
    <script>
      const userMode = localStorage.getItem('vuepress-color-scheme');
			const systemDarkMode = window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches;
			if (userMode === 'dark' || (userMode !== 'light' && systemDarkMode)) {
				document.documentElement.classList.toggle('dark', true);
			}
    </script>
    <link rel="icon" href="/img/logo.png"><meta name="viewport" content="width=device-width,initial-scale=1,user-scalable=no"><script data-ad-client="ca-pub-1562813649031072" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script><title>Elasticsearch 安装 & 使用 | 首页</title><meta name="description" content="">
    <link rel="preload" href="/assets/style-e0f39699.css" as="style"><link rel="stylesheet" href="/assets/style-e0f39699.css">
    <link rel="modulepreload" href="/assets/app-2f10a28c.js"><link rel="modulepreload" href="/assets/es安装与使用.html-955c7c66.js"><link rel="modulepreload" href="/assets/es安装与使用.html-8f1f66c0.js"><link rel="prefetch" href="/assets/index.html-c13ba13c.js" as="script"><link rel="prefetch" href="/assets/stringer.html-8439e7a2.js" as="script"><link rel="prefetch" href="/assets/index.html-070be700.js" as="script"><link rel="prefetch" href="/assets/基础.html-2be12934.js" as="script"><link rel="prefetch" href="/assets/抽象语法树ast库使用.html-a84447a8.js" as="script"><link rel="prefetch" href="/assets/READMIN.html-2a428420.js" as="script"><link rel="prefetch" href="/assets/ES检索原理分析.html-8969a25b.js" as="script"><link rel="prefetch" href="/assets/ES高级查询.html-6c64f000.js" as="script"><link rel="prefetch" href="/assets/GOLANG操作ES.html-6d49b368.js" as="script"><link rel="prefetch" href="/assets/index.html-c6ae131c.js" as="script"><link rel="prefetch" href="/assets/kibana安装与使用.html-4ffb72d8.js" as="script"><link rel="prefetch" href="/assets/基础功能.html-385183c5.js" as="script"><link rel="prefetch" href="/assets/批量操作.html-2ef68ebd.js" as="script"><link rel="prefetch" href="/assets/索引模版.html-16aebd60.js" as="script"><link rel="prefetch" href="/assets/index.html-b6622fdd.js" as="script"><link rel="prefetch" href="/assets/代写文书使用帮助.html-9647bbd0.js" as="script"><link rel="prefetch" href="/assets/代写法律文书.html-af9390a8.js" as="script"><link rel="prefetch" href="/assets/环境依赖.html-4bb6bfd8.js" as="script"><link rel="prefetch" href="/assets/index.html-ff38b3f6.js" as="script"><link rel="prefetch" href="/assets/golang1.html-309adcaa.js" as="script"><link rel="prefetch" href="/assets/index.html-7a59f388.js" as="script"><link rel="prefetch" href="/assets/index.html-ce87c1bb.js" as="script"><link rel="prefetch" href="/assets/index.html-813fe462.js" as="script"><link rel="prefetch" href="/assets/index.html-ac24a345.js" as="script"><link rel="prefetch" href="/assets/时序图.html-7cf42b6a.js" as="script"><link rel="prefetch" href="/assets/404.html-60b35caa.js" as="script"><link rel="prefetch" href="/assets/index.html-836e03fd.js" as="script"><link rel="prefetch" href="/assets/stringer.html-83569d8d.js" as="script"><link rel="prefetch" href="/assets/index.html-55b4f83e.js" as="script"><link rel="prefetch" href="/assets/基础.html-02742aab.js" as="script"><link rel="prefetch" href="/assets/抽象语法树ast库使用.html-01880890.js" as="script"><link rel="prefetch" href="/assets/READMIN.html-145b3644.js" as="script"><link rel="prefetch" href="/assets/ES检索原理分析.html-3b4d3277.js" as="script"><link rel="prefetch" href="/assets/ES高级查询.html-7229a1f6.js" as="script"><link rel="prefetch" href="/assets/GOLANG操作ES.html-502fa4f5.js" as="script"><link rel="prefetch" href="/assets/index.html-8ad6114f.js" as="script"><link rel="prefetch" href="/assets/kibana安装与使用.html-b60c286c.js" as="script"><link rel="prefetch" href="/assets/基础功能.html-b9a732ba.js" as="script"><link rel="prefetch" href="/assets/批量操作.html-76ef0178.js" as="script"><link rel="prefetch" href="/assets/索引模版.html-8bcff02a.js" as="script"><link rel="prefetch" href="/assets/index.html-eb42597c.js" as="script"><link rel="prefetch" href="/assets/代写文书使用帮助.html-b57ce7c4.js" as="script"><link rel="prefetch" href="/assets/代写法律文书.html-7d00b4ac.js" as="script"><link rel="prefetch" href="/assets/环境依赖.html-ed6b46d5.js" as="script"><link rel="prefetch" href="/assets/index.html-aeb4faa4.js" as="script"><link rel="prefetch" href="/assets/golang1.html-2afabadb.js" as="script"><link rel="prefetch" href="/assets/index.html-141c256f.js" as="script"><link rel="prefetch" href="/assets/index.html-4d947e03.js" as="script"><link rel="prefetch" href="/assets/index.html-60a3362c.js" as="script"><link rel="prefetch" href="/assets/index.html-9af0598e.js" as="script"><link rel="prefetch" href="/assets/时序图.html-b8a06745.js" as="script"><link rel="prefetch" href="/assets/404.html-0ab50ca1.js" as="script"><link rel="prefetch" href="/assets/style-e9220a04.js" as="script"><link rel="prefetch" href="/assets/docsearch-1d421ddb.js" as="script"><link rel="prefetch" href="/assets/index-d20b7d60.js" as="script">
  </head>
  <body>
    <div id="app"><!--[--><div class="theme-container"><!--[--><header class="navbar"><div class="toggle-sidebar-button" title="toggle sidebar" aria-expanded="false" role="button" tabindex="0"><div class="icon" aria-hidden="true"><span></span><span></span><span></span></div></div><span><a href="/" class=""><img class="logo" src="/img/logo.png" alt="首页"><span class="site-name can-hide">首页</span></a></span><div class="navbar-items-wrapper" style=""><!--[--><!--]--><nav class="navbar-items can-hide"><!--[--><div class="navbar-item"><div class="navbar-dropdown-wrapper"><button class="navbar-dropdown-title" type="button" aria-label="工具软件"><span class="title">工具软件</span><span class="arrow down"></span></button><button class="navbar-dropdown-title-mobile" type="button" aria-label="工具软件"><span class="title">工具软件</span><span class="right arrow"></span></button><ul style="display:none;" class="navbar-dropdown"><!--[--><li class="navbar-dropdown-item"><a href="/tool/git" class="" aria-label="GIT"><!--[--><!--]--> GIT <!--[--><!--]--></a></li><!--]--></ul></div></div><div class="navbar-item"><div class="navbar-dropdown-wrapper"><button class="navbar-dropdown-title" type="button" aria-label="golang"><span class="title">golang</span><span class="arrow down"></span></button><button class="navbar-dropdown-title-mobile" type="button" aria-label="golang"><span class="title">golang</span><span class="right arrow"></span></button><ul style="display:none;" class="navbar-dropdown"><!--[--><li class="navbar-dropdown-item"><a href="/golang/cmd/stringer" class="" aria-label="cmd工具"><!--[--><!--]--> cmd工具 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/golang/tool/" class="" aria-label="工具包"><!--[--><!--]--> 工具包 <!--[--><!--]--></a></li><!--]--></ul></div></div><div class="navbar-item"><div class="navbar-dropdown-wrapper"><button class="navbar-dropdown-title" type="button" aria-label="数据库"><span class="title">数据库</span><span class="arrow down"></span></button><button class="navbar-dropdown-title-mobile" type="button" aria-label="数据库"><span class="title">数据库</span><span class="right arrow"></span></button><ul style="display:none;" class="navbar-dropdown"><!--[--><li class="navbar-dropdown-item"><a href="/database/mongodb/" class="" aria-label="Mongodb"><!--[--><!--]--> Mongodb <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/database/mysql/" class="" aria-label="Mysql"><!--[--><!--]--> Mysql <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/database/redis/" class="" aria-label="Redis"><!--[--><!--]--> Redis <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/database/elasticsearch/" class="router-link-active" aria-label="Elasticsearch"><!--[--><!--]--> Elasticsearch <!--[--><!--]--></a></li><!--]--></ul></div></div><div class="navbar-item"><div class="navbar-dropdown-wrapper"><button class="navbar-dropdown-title" type="button" aria-label="产品设计"><span class="title">产品设计</span><span class="arrow down"></span></button><button class="navbar-dropdown-title-mobile" type="button" aria-label="产品设计"><span class="title">产品设计</span><span class="right arrow"></span></button><ul style="display:none;" class="navbar-dropdown"><!--[--><li class="navbar-dropdown-item"><a href="/productDesgin/uml/时序图.html" class="" aria-label="UML"><!--[--><!--]--> UML <!--[--><!--]--></a></li><!--]--></ul></div></div><!--]--></nav><!--[--><!--]--><button class="toggle-color-mode-button" title><svg style="" class="icon" focusable="false" viewBox="0 0 32 32"><path d="M16 12.005a4 4 0 1 1-4 4a4.005 4.005 0 0 1 4-4m0-2a6 6 0 1 0 6 6a6 6 0 0 0-6-6z" fill="currentColor"></path><path d="M5.394 6.813l1.414-1.415l3.506 3.506L8.9 10.318z" fill="currentColor"></path><path d="M2 15.005h5v2H2z" fill="currentColor"></path><path d="M5.394 25.197L8.9 21.691l1.414 1.415l-3.506 3.505z" fill="currentColor"></path><path d="M15 25.005h2v5h-2z" fill="currentColor"></path><path d="M21.687 23.106l1.414-1.415l3.506 3.506l-1.414 1.414z" fill="currentColor"></path><path d="M25 15.005h5v2h-5z" fill="currentColor"></path><path d="M21.687 8.904l3.506-3.506l1.414 1.415l-3.506 3.505z" fill="currentColor"></path><path d="M15 2.005h2v5h-2z" fill="currentColor"></path></svg><svg style="display:none;" class="icon" focusable="false" viewBox="0 0 32 32"><path d="M13.502 5.414a15.075 15.075 0 0 0 11.594 18.194a11.113 11.113 0 0 1-7.975 3.39c-.138 0-.278.005-.418 0a11.094 11.094 0 0 1-3.2-21.584M14.98 3a1.002 1.002 0 0 0-.175.016a13.096 13.096 0 0 0 1.825 25.981c.164.006.328 0 .49 0a13.072 13.072 0 0 0 10.703-5.555a1.01 1.01 0 0 0-.783-1.565A13.08 13.08 0 0 1 15.89 4.38A1.015 1.015 0 0 0 14.98 3z" fill="currentColor"></path></svg></button><!--[--><div id="docsearch-container" style="display:none;"></div><div><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"><kbd class="DocSearch-Button-Key"><svg width="15" height="15" class="DocSearch-Control-Key-Icon"><path d="M4.505 4.496h2M5.505 5.496v5M8.216 4.496l.055 5.993M10 7.5c.333.333.5.667.5 1v2M12.326 4.5v5.996M8.384 4.496c1.674 0 2.116 0 2.116 1.5s-.442 1.5-2.116 1.5M3.205 9.303c-.09.448-.277 1.21-1.241 1.203C1 10.5.5 9.513.5 8V7c0-1.57.5-2.5 1.464-2.494.964.006 1.134.598 1.24 1.342M12.553 10.5h1.953" stroke-width="1.2" stroke="currentColor" fill="none" stroke-linecap="square"></path></svg></kbd><kbd class="DocSearch-Button-Key">K</kbd></span></button></div><!--]--></div></header><!--]--><div class="sidebar-mask"></div><!--[--><aside class="sidebar"><nav class="navbar-items"><!--[--><div class="navbar-item"><div class="navbar-dropdown-wrapper"><button class="navbar-dropdown-title" type="button" aria-label="工具软件"><span class="title">工具软件</span><span class="arrow down"></span></button><button class="navbar-dropdown-title-mobile" type="button" aria-label="工具软件"><span class="title">工具软件</span><span class="right arrow"></span></button><ul style="display:none;" class="navbar-dropdown"><!--[--><li class="navbar-dropdown-item"><a href="/tool/git" class="" aria-label="GIT"><!--[--><!--]--> GIT <!--[--><!--]--></a></li><!--]--></ul></div></div><div class="navbar-item"><div class="navbar-dropdown-wrapper"><button class="navbar-dropdown-title" type="button" aria-label="golang"><span class="title">golang</span><span class="arrow down"></span></button><button class="navbar-dropdown-title-mobile" type="button" aria-label="golang"><span class="title">golang</span><span class="right arrow"></span></button><ul style="display:none;" class="navbar-dropdown"><!--[--><li class="navbar-dropdown-item"><a href="/golang/cmd/stringer" class="" aria-label="cmd工具"><!--[--><!--]--> cmd工具 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/golang/tool/" class="" aria-label="工具包"><!--[--><!--]--> 工具包 <!--[--><!--]--></a></li><!--]--></ul></div></div><div class="navbar-item"><div class="navbar-dropdown-wrapper"><button class="navbar-dropdown-title" type="button" aria-label="数据库"><span class="title">数据库</span><span class="arrow down"></span></button><button class="navbar-dropdown-title-mobile" type="button" aria-label="数据库"><span class="title">数据库</span><span class="right arrow"></span></button><ul style="display:none;" class="navbar-dropdown"><!--[--><li class="navbar-dropdown-item"><a href="/database/mongodb/" class="" aria-label="Mongodb"><!--[--><!--]--> Mongodb <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/database/mysql/" class="" aria-label="Mysql"><!--[--><!--]--> Mysql <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/database/redis/" class="" aria-label="Redis"><!--[--><!--]--> Redis <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/database/elasticsearch/" class="router-link-active" aria-label="Elasticsearch"><!--[--><!--]--> Elasticsearch <!--[--><!--]--></a></li><!--]--></ul></div></div><div class="navbar-item"><div class="navbar-dropdown-wrapper"><button class="navbar-dropdown-title" type="button" aria-label="产品设计"><span class="title">产品设计</span><span class="arrow down"></span></button><button class="navbar-dropdown-title-mobile" type="button" aria-label="产品设计"><span class="title">产品设计</span><span class="right arrow"></span></button><ul style="display:none;" class="navbar-dropdown"><!--[--><li class="navbar-dropdown-item"><a href="/productDesgin/uml/时序图.html" class="" aria-label="UML"><!--[--><!--]--> UML <!--[--><!--]--></a></li><!--]--></ul></div></div><!--]--></nav><!--[--><!--]--><ul class="sidebar-items"><!--[--><li><a href="/database/elasticsearch/README.md" class="sidebar-item sidebar-heading" aria-label="概述"><!--[--><!--]--> 概述 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/database/elasticsearch/es%E5%AE%89%E8%A3%85%E4%B8%8E%E4%BD%BF%E7%94%A8.html" class="router-link-active router-link-exact-active router-link-active sidebar-item sidebar-heading active" aria-label="Elasticsearch 安装 &amp; 使用"><!--[--><!--]--> Elasticsearch 安装 &amp; 使用 <!--[--><!--]--></a><ul style="" class="sidebar-item-children"><!--[--><li><a aria-current="page" href="/database/elasticsearch/es%E5%AE%89%E8%A3%85%E4%B8%8E%E4%BD%BF%E7%94%A8.html#下载软件" class="router-link-active router-link-exact-active sidebar-item" aria-label="下载软件"><!--[--><!--]--> 下载软件 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/database/elasticsearch/es%E5%AE%89%E8%A3%85%E4%B8%8E%E4%BD%BF%E7%94%A8.html#安装软件" class="router-link-active router-link-exact-active sidebar-item" aria-label="安装软件"><!--[--><!--]--> 安装软件 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/database/elasticsearch/es%E5%AE%89%E8%A3%85%E4%B8%8E%E4%BD%BF%E7%94%A8.html#问题解决" class="router-link-active router-link-exact-active sidebar-item" aria-label="问题解决"><!--[--><!--]--> 问题解决 <!--[--><!--]--></a><!----></li><!--]--></ul></li><li><a href="/database/elasticsearch/kibana%E5%AE%89%E8%A3%85%E4%B8%8E%E4%BD%BF%E7%94%A8.html" class="sidebar-item sidebar-heading" aria-label="Kibana 安装&amp;使用"><!--[--><!--]--> Kibana 安装&amp;使用 <!--[--><!--]--></a><!----></li><li><a href="/database/elasticsearch/%E5%9F%BA%E7%A1%80%E5%8A%9F%E8%83%BD.html" class="sidebar-item sidebar-heading" aria-label="基础功能"><!--[--><!--]--> 基础功能 <!--[--><!--]--></a><!----></li><li><a href="/database/elasticsearch/%E6%89%B9%E9%87%8F%E6%93%8D%E4%BD%9C.html" class="sidebar-item sidebar-heading" aria-label="文档批量操作"><!--[--><!--]--> 文档批量操作 <!--[--><!--]--></a><!----></li><li><a href="/database/elasticsearch/ES%E6%A3%80%E7%B4%A2%E5%8E%9F%E7%90%86%E5%88%86%E6%9E%90.html" class="sidebar-item sidebar-heading" aria-label="ES检索原理分析"><!--[--><!--]--> ES检索原理分析 <!--[--><!--]--></a><!----></li><li><a href="/database/elasticsearch/ES%E9%AB%98%E7%BA%A7%E6%9F%A5%E8%AF%A2.html" class="sidebar-item sidebar-heading" aria-label="高级查询"><!--[--><!--]--> 高级查询 <!--[--><!--]--></a><!----></li><li><a href="/database/elasticsearch/%E7%B4%A2%E5%BC%95%E6%A8%A1%E7%89%88.html" class="sidebar-item sidebar-heading" aria-label="索引模版"><!--[--><!--]--> 索引模版 <!--[--><!--]--></a><!----></li><li><a href="/database/elasticsearch/GOLANG%E6%93%8D%E4%BD%9CES.html" class="sidebar-item sidebar-heading" aria-label="GOLANG操作ES"><!--[--><!--]--> GOLANG操作ES <!--[--><!--]--></a><!----></li><!--]--></ul><!--[--><!--]--></aside><!--]--><!--[--><main class="page"><!--[--><!--]--><div class="theme-default-content"><!--[--><!--]--><div><h1 id="elasticsearch-安装-使用" tabindex="-1"><a class="header-anchor" href="#elasticsearch-安装-使用" aria-hidden="true">#</a> <strong>Elasticsearch</strong> <strong>安装</strong> <strong>&amp;</strong> <strong>使用</strong></h1><p>本章是根据尚硅谷教学视频编写 <a href="https://www.bilibili.com/video/BV1hh411D7sb/?spm_id_from=333.337.search-card.all.click&amp;vd_source=c2c3977953334eb68fd28f89418ceaa6" target="_blank" rel="noopener noreferrer">https://www.bilibili.com/video/BV1hh411D7sb/?spm_id_from=333.337.search-card.all.click&amp;vd_source=c2c3977953334eb68fd28f89418ceaa6<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></p><h2 id="下载软件" tabindex="-1"><a class="header-anchor" href="#下载软件" aria-hidden="true">#</a> <strong>下载软件</strong></h2><p>Elasticsearch 的官方地址：https://www.elastic.co/cn/</p><p>Elasticsearch 最新的版本是 8.2.3（截止 2022.06.15），我们选择略早的 8.1.0 版本</p><p>下载地址：https://www.elastic.co/cn/downloads/past-releases#elasticsearch</p><img src="/assets/download-93d22966.png" alt="image-20220927135705960" style="zoom:33%;"><p>可以根据情况自行选择不同操作系统的版本。</p><h2 id="安装软件" tabindex="-1"><a class="header-anchor" href="#安装软件" aria-hidden="true">#</a> 安装软件</h2><p>针对新版ES软件的特性与应用，所以采用Linux集群配置</p><ol><li><p>集群规划</p><p>为了演示软件的使用，我们这里准备三台 linux 虚拟机，用于配置 Elasticsearch 集群。</p><p>启动集群后，每台虚拟机的进程如下：</p><table><thead><tr><th>主机名</th><th>linux1</th><th>linux2</th><th>linux3</th></tr></thead><tbody><tr><td>进程名</td><td>Elasticsearch(es-node-1)</td><td>Elasticsearch(es-node-2)</td><td>Elasticsearch(es-node-3)</td></tr></tbody></table><p>Linux 系统环境配置请参考之前课程内容。这里我们给三台虚拟机搭建 ES 集群，集群</p><p>中-节点名称依次为 es-node-1，es-node-2，es-node-3</p></li><li><p>将压缩包 elasticsearch-8.1.0-linux-x86_64.tar.gz 上传到虚拟机中</p><p>解压缩文件到自定义路径，笔者解压路径为：/opt/module,解压后，软件路径为：</p><p>/opt/module/elasticsearch-8.1.0</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token comment"># 切换目录</span>
<span class="token builtin class-name">cd</span> software
<span class="token comment"># 解压缩</span>
<span class="token function">tar</span> <span class="token parameter variable">-zxvf</span> elasticsearch-8.1.0-linux-x86_64.tar.gz <span class="token parameter variable">-C</span> /opt/module
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>解压后的 Elasticsearch 的目录结构如下</p><img src="/elasticsearch/1.png" alt="image-20220927135705960" style="zoom:100%;"><table><thead><tr><th>目录</th><th>含义</th></tr></thead><tbody><tr><td>bin</td><td>可执行脚本目录</td></tr><tr><td>config</td><td>配置目录</td></tr><tr><td>jdk</td><td>内置JDK目录</td></tr><tr><td>lib</td><td>类库</td></tr><tr><td>logs</td><td>日志目录</td></tr><tr><td>modules</td><td>模块目录</td></tr><tr><td>plugins</td><td>插件目录</td></tr></tbody></table></li><li><p>当前安装 ES 版本为 8.1.0，自带 JDK，所以当前 Linux 虚拟机节点无需配置 Java 环境</p></li><li><p>创建linux新用户es，数据文件，证书目录，并修改Elasticsearch文件拥有者</p><p><code>由于es不允许root用户操作，所以需要创建新用户</code></p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token comment"># 新增es用户</span>
<span class="token function">useradd</span> es
<span class="token comment"># 为es用户设置密码</span>
<span class="token function">passwd</span> es

<span class="token comment"># 创建数据文件目录</span>
<span class="token function">mkdir</span> /opt/module/elasticsearch-8.1.0/data
<span class="token comment"># 创建证书目录</span>
<span class="token function">mkdir</span> /opt/module/elasticsearch-8.1.0/config/certs
<span class="token comment"># 切换目录</span>
<span class="token builtin class-name">cd</span> /opt/module/elasticsearch-8.1.0

<span class="token comment"># 修改文件拥有者</span>
<span class="token function">chown</span> <span class="token parameter variable">-R</span> es:es /opt/module/elasticsearch-8.1.0
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p>在第一台服务器节点es-node-1设置集群多节点通信密钥</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token comment"># 切换用户</span>
<span class="token function">su</span> es

<span class="token comment"># 签发 ca 证书，过程中需按两次回车键</span>
bin/elasticsearch-certutil ca
<span class="token comment"># 用 ca 证书签发节点证书，过程中需按三次回车键</span>
bin/elasticsearch-certutil cert <span class="token parameter variable">--ca</span> elastic-stack-ca.p12

<span class="token comment"># 将生成的证书文件移动到 config/certs 目录中</span>
<span class="token function">mv</span> elastic-stack-ca.p12 elastic-certificates.p12 config/certs
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p>在第一台服务器节点es-node-1设置集群多节点HTTP证书</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token comment"># 签发 Https 证书</span>
bin/elasticsearch-certutil http
<span class="token comment"># 以下是每次要求输入时，需要输入的内容</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><img src="/assets/3-ba553835.png" alt="image-20220927135705960" style="zoom:66%;"><img src="/assets/2-87389eaa.png" alt="image-20220927135705960" style="zoom:66%;"><p>指定证书路径</p><img src="/assets/4-46241815.png" alt="image-20220927135705960" style="zoom:66%;"><p>无需输入密码</p><img src="/assets/image-20220927153941132-db2a4815.png" alt="image-20220927153941132" style="zoom:67%;"><p>设置证书失效时间</p><img src="/assets/image-20220927154149016-12ca04e6.png" alt="image-20220927154149016" style="zoom:67%;"><p>无需每个节点配置证书</p><img src="/assets/image-20220927154230580-21393ce6.png" alt="image-20220927154230580" style="zoom:67%;"><p>输出连接到第一个节点的所有主机名</p><img src="/assets/image-20220927154313380-dca2bb9b.png" alt="image-20220927154313380" style="zoom:67%;"><p>输出连接到第一个基点的所有主机 <strong>IP</strong> 地址</p><img src="/assets/image-20220927154437177-6d306378.png" alt="image-20220927154437177" style="zoom:67%;"><p>不改变证书选项配置</p><img src="/assets/image-20220927154528494-896dd9fc.png" alt="image-20220927154528494" style="zoom:67%;"><p>不给证书加密，按键输入两次回车</p><img src="/assets/image-20220927154618352-4ea44c7e.png" alt="image-20220927154618352" style="zoom:67%;"><p>解压刚刚生成的zip包</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token comment"># 解压文件</span>
<span class="token function">unzip</span> elasticsearch-ssl-http.zip
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><p>将解压后的证书文件移动到config/certs目录中</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token comment"># 移动文件</span>
<span class="token function">mv</span> elasticsearch/http.p12 kibana/elasticsearch-ca.pem config/certs
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p>修改住配置文件：config/elasticsearch.yml</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token comment"># 设置 ES 集群名称</span>
cluster.name: es-cluster
<span class="token comment"># 设置集群中当前节点名称</span>
node.name: es-node-1
<span class="token comment"># 设置数据，日志文件路径</span>
path.data: /opt/module/elasticsearch-8.1.0/data
path.logs: /opt/module/elasticsearch-8.1.0/log
<span class="token comment"># 设置网络访问节点</span>
network.host: linux1
<span class="token comment"># 设置网络访问端口</span>
http.port: <span class="token number">9200</span>
<span class="token comment"># 初始节点</span>
discovery.seed_hosts: <span class="token punctuation">[</span><span class="token string">&quot;linux1&quot;</span><span class="token punctuation">]</span>
<span class="token comment"># 安全认证</span>
xpack.security.enabled: <span class="token boolean">true</span>
xpack.security.enrollment.enabled: <span class="token boolean">true</span>
xpack.security.http.ssl:
 enabled: <span class="token boolean">true</span>
 keystore.path: /opt/module/elasticsearch-8.1.0/config/certs/http.p12
 truststore.path: /opt/module/elasticsearch-8.1.0/config/certs/http.p12
xpack.security.transport.ssl:
 enabled: <span class="token boolean">true</span>
 verification_mode: certificate
 keystore.path:
/opt/module/elasticsearch-8.1.0/config/certs/elastic-certificates.p12
 truststore.path:
/opt/module/elasticsearch-8.1.0/config/certs/elastic-certificates.p12
<span class="token comment"># 此处需注意，es-node-1 为上面配置的节点名称</span>
cluster.initial_master_nodes: <span class="token punctuation">[</span><span class="token string">&quot;es-node-1&quot;</span><span class="token punctuation">]</span>
http.host: <span class="token punctuation">[</span>_local_, _site_<span class="token punctuation">]</span>
ingest.geoip.downloader.enabled: <span class="token boolean">false</span>
xpack.security.http.ssl.client_authentication: none
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p>启动ES软件</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token comment"># 启动ES软件</span>
bin/elasticsearch
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div></li></ol><p>第一次成功启动后，会显示密码，请记住，访问时需要。只有第一次才有！</p><img src="/assets/image-20220927162802262-d96f57c8.png" alt="image-20220927162802262" style="zoom:67%;"><!----><!----><img src="/assets/image-20220927163303119-408e07a0.png" alt="image-20220927163303119" style="zoom:50%;"><p><img src="/assets/image-20220927163357772-3cb7ab4f.png" alt="image-20220927163357772"></p><p>注意：9300端口为Elasticsearch集群间组件的通信端口，9200端口为浏览器访问的http协议RESTFUL端口。</p><ol start="9"><li><p>访问服务器节点https://虚拟机地址:9200</p><p>因为配置了安全协议，所以使用https协议进行访问，但由于证书是自己生成的，并不可靠，所以会有安全提示</p><img src="/assets/image-20220927163743685-a70b9409.png" alt="image-20220927163743685" style="zoom:50%;"><p>选择继续或在该页面直接敲thisisunsafe即可</p><img src="/assets/image-20220927163905182-943e0e5b.png" alt="image-20220927163905182" style="zoom:50%;"><p>输入账号，密码登陆即可</p><img src="/assets/image-20220927163951266-3cee2eef.png" alt="image-20220927163951266" style="zoom:50%;"></li><li><p>修改集群中的其他节点配置文件：config/elasticsearch.yml</p><p>linux2: 证书直接拷贝，其他步骤完全相同，配置文件中修改如下内容即可</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token comment"># 设置节点名称</span>
node.name: es-node-2
<span class="token comment"># 设置网络访问主机</span>
network.host: linux2
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>linux3:证书直接拷贝，其他步骤完全相同，配置文件中修改如下内容即可</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token comment"># 设置节点名称</span>
node.name: es-node-3
<span class="token comment"># 设置网络访问主机</span>
network.host: linux3
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p>依次启动集群的三台服务器节点, <!----></p><p>Linux1、linux2、linux3:</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token comment"># 后台启动服务</span>
bin/elasticsearch <span class="token parameter variable">-d</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div></li></ol><h2 id="问题解决" tabindex="-1"><a class="header-anchor" href="#问题解决" aria-hidden="true">#</a> 问题解决</h2><ul><li><p>Elasticsearch 是使用 java 开发的，8.1 版本的 ES 需要 JDK17 及以上版本。默认安装包 中带有 JDK 环境，如果系统配置 ES_JAVA_HOME 环境变量，那么会采用系统配置的 JDK。如果没有配置该环境变量，ES 会使用自带捆绑的 JDK。虽然自带的 JDK 是 ES 软件推荐的 Java 版本，但一般建议使用系统配置的 JDK。</p></li><li><p>Windows 环境中出现下面的错误信息，是因为开启了 SSL 认证：</p><img src="/assets/image-20220927164758235-02c0c135.png" alt="image-20220927164758235" style="zoom:50%;"><p>修改 config/elasticsearch.yml 文件，将 enabled 的值修改为 false</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token comment"># Enable encryption for HTTP API client connections, such as Kibana, Logstash,</span>
and Agents
xpack.security.http.ssl:
 enabled: <span class="token boolean">false</span>
 keystore.path: certs/http.p12
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p>启动成功后，如果访问 localhost:9200 地址后，弹出登录窗口</p><p>第一次启动时，因为开启了密码验证模式，在启动窗口中会显示输入账号和密码。如果 没有注意到或没有找到账号密码，可以设置免密登录：</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token comment"># Enable security features</span>
xpack.security.enabled: <span class="token boolean">false</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p>双击启动窗口闪退，通过路径访问追踪错误，如果是“空间不足”，请修改config/jvm.options 配置文件</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token comment"># 设置 JVM 初始内存为 1G。此值可以设置与-Xmx 相同，以避免每次垃圾回收完成后 JVM 重新分配</span>
内存
<span class="token comment"># Xms represents the initial size of total heap space</span>
<span class="token comment"># 设置 JVM 最大可用内存为 1G</span>
<span class="token comment"># Xmx represents the maximum size of total heap space</span>
<span class="token parameter variable">-Xms4g</span>
<span class="token parameter variable">-Xmx4g</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p>启动后，如果密码忘记了，怎么办？可以采用指令重置密码</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token comment"># 使用 es 用户，执行指令，重置 elastic 用户密码</span>
bin/elasticsearch-reset-password <span class="token parameter variable">-u</span> elastic
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><img src="/assets/image-20220927165222266-286384e2.png" alt="image-20220927165222266" style="zoom:50%;"><p>如果只启动单一节点，此操作可能会失败，至少启动 2 个节点，测试成功</p></li></ul></div><!--[--><!--]--></div><footer class="page-meta"><!----><div class="meta-item last-updated"><span class="meta-item-label">最后更新时间: </span><!----></div><div class="meta-item contributors"><span class="meta-item-label">贡献者: </span><span class="meta-item-info"><!--[--><!--[--><span class="contributor" title="email: thomas@deepscm.com">thomas</span><!----><!--]--><!--]--></span></div></footer><nav class="page-nav"><p class="inner"><span class="prev"><a href="/database/elasticsearch/README.md" class="" aria-label="概述"><!--[--><!--]--> 概述 <!--[--><!--]--></a></span><span class="next"><a href="/database/elasticsearch/kibana%E5%AE%89%E8%A3%85%E4%B8%8E%E4%BD%BF%E7%94%A8.html" class="" aria-label="Kibana 安装&amp;使用"><!--[--><!--]--> Kibana 安装&amp;使用 <!--[--><!--]--></a></span></p></nav><!--[--><!--]--></main><!--]--></div><!----><!--]--></div>
    <script type="module" src="/assets/app-2f10a28c.js" defer></script>
  </body>
</html>
