import{_ as s,o as a,c as n,R as l}from"./chunks/framework.333b51ca.js";const D=JSON.parse('{"title":"PostgreSQL 查看数据库中对象的大小","description":"","frontmatter":{},"headers":[],"relativePath":"database/postgreSQL/databaseAndTable/查看空间.md","filePath":"database/postgreSQL/databaseAndTable/查看空间.md","lastUpdated":1689061386000}'),p={name:"database/postgreSQL/databaseAndTable/查看空间.md"},e=l(`<h1 id="postgresql-查看数据库中对象的大小" tabindex="-1">PostgreSQL 查看数据库中对象的大小 <a class="header-anchor" href="#postgresql-查看数据库中对象的大小" aria-label="Permalink to &quot;PostgreSQL 查看数据库中对象的大小&quot;">​</a></h1><p>本文介绍了在 PostgreSQL 如何查看数据库、表、索引和表空间的大小。</p><p>作为数据库管理者，您经常需要查看数据库的占用空间，这包括 数据库、表、索引和表空间的大小，以便为他们分配合理的存储空间。</p><h2 id="postgresql-数据库大小" tabindex="-1">PostgreSQL 数据库大小 <a class="header-anchor" href="#postgresql-数据库大小" aria-label="Permalink to &quot;PostgreSQL 数据库大小&quot;">​</a></h2><p>您可以使用 <code>pg_database_size()</code> 函数获取整个数据库的大小。例如，以下语句返回 <code>testdb</code> 数据库的大小：</p><div class="language-sql"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#F78C6C;">SELECT</span><span style="color:#A6ACCD;"> pg_database_size(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">testdb</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">);</span></span></code></pre></div><div class="language-bash"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#FFCB6B;">pg_database_size</span></span>
<span class="line"><span style="color:#FFCB6B;">------------------</span></span>
<span class="line"><span style="color:#A6ACCD;">          </span><span style="color:#FFCB6B;">9044483</span></span></code></pre></div><p><code>pg_database_size()</code> 函数以字节为单位返回数据库的大小，这不容易阅读。您可以使用 <code>pg_size_pretty()</code> 函数将字节转为更易于阅读值。如下：</p><div class="language-sql"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#F78C6C;">SELECT</span></span>
<span class="line"><span style="color:#A6ACCD;">  pg_size_pretty(</span></span>
<span class="line"><span style="color:#A6ACCD;">    pg_database_size(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">testdb</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">)</span></span>
<span class="line"><span style="color:#A6ACCD;">  );</span></span></code></pre></div><p>该语句返回以下结果：</p><div class="language-bash"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#FFCB6B;">pg_size_pretty</span></span>
<span class="line"><span style="color:#FFCB6B;">----------------</span></span>
<span class="line"><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">8833</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">kB</span></span></code></pre></div><p>如果您想要要获取当前数据库服务器中所有数据库的大小，请使用以下语句：</p><div class="language-sql"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#F78C6C;">SELECT</span></span>
<span class="line"><span style="color:#A6ACCD;">  datname,</span></span>
<span class="line"><span style="color:#A6ACCD;">  pg_size_pretty(pg_database_size(datname)) </span><span style="color:#F78C6C;">AS</span><span style="color:#A6ACCD;"> size</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F78C6C;">FROM</span><span style="color:#A6ACCD;"> pg_database;</span></span></code></pre></div><div class="language-bash"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#FFCB6B;">datname</span><span style="color:#A6ACCD;">   </span><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;">  </span><span style="color:#FFCB6B;">size</span></span>
<span class="line"><span style="color:#FFCB6B;">-------------+---------</span></span>
<span class="line"><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">postgres</span><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">8561</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">kB</span></span>
<span class="line"><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">template1</span><span style="color:#A6ACCD;">   </span><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">8401</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">kB</span></span>
<span class="line"><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">template0</span><span style="color:#A6ACCD;">   </span><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">8401</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">kB</span></span>
<span class="line"><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">testdb</span><span style="color:#A6ACCD;">      </span><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">8833</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">kB</span></span>
<span class="line"><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">sakila</span><span style="color:#A6ACCD;">      </span><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">16</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">MB</span></span>
<span class="line"><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">testdb2</span><span style="color:#A6ACCD;">     </span><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">8521</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">kB</span></span>
<span class="line"><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">test_new_db</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">8401</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">kB</span></span></code></pre></div><h2 id="postgresql-表大小" tabindex="-1">PostgreSQL 表大小 <a class="header-anchor" href="#postgresql-表大小" aria-label="Permalink to &quot;PostgreSQL 表大小&quot;">​</a></h2><p>您可以使用 <code>pg_relation_size()</code> 函数获取一个表的大小。例如，以下语句返回 <a href="./示例数据库.html">PostgreSQL Sakila 示例数据库</a>中的 <code>actor</code> 表的大小：</p><div class="language-sql"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#F78C6C;">SELECT</span></span>
<span class="line"><span style="color:#A6ACCD;">  pg_size_pretty(</span></span>
<span class="line"><span style="color:#A6ACCD;">    pg_relation_size(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">actor</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">)</span></span>
<span class="line"><span style="color:#A6ACCD;">  );</span></span></code></pre></div><div class="language-bash"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#FFCB6B;">pg_size_pretty</span></span>
<span class="line"><span style="color:#FFCB6B;">----------------</span></span>
<span class="line"><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">16</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">kB</span></span></code></pre></div><p><code>pg_relation_size()</code> 函数返回表的数据的大小，不包含表中的索引的大小。如果要获取表的总的大小，请使用 <code>pg_total_relation_size()</code> 函数， 如下：</p><div class="language-sql"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#F78C6C;">SELECT</span></span>
<span class="line"><span style="color:#A6ACCD;">  pg_size_pretty(</span></span>
<span class="line"><span style="color:#A6ACCD;">    pg_total_relation_size(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">actor</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">)</span></span>
<span class="line"><span style="color:#A6ACCD;">  );</span></span></code></pre></div><div class="language-txt"><button title="Copy Code" class="copy"></button><span class="lang">txt</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#A6ACCD;">pg_size_pretty</span></span>
<span class="line"><span style="color:#A6ACCD;">----------------</span></span>
<span class="line"><span style="color:#A6ACCD;"> 72 kB</span></span></code></pre></div><p>要获取数据库中所有的表的大小，您可以使用如下语句：</p><div class="language-sql"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#F78C6C;">SELECT</span></span>
<span class="line"><span style="color:#A6ACCD;">  tablename,</span></span>
<span class="line"><span style="color:#A6ACCD;">  pg_size_pretty(pg_total_relation_size(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">actor</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">)) size</span></span>
<span class="line"><span style="color:#F78C6C;">FROM</span><span style="color:#A6ACCD;"> pg_tables</span></span>
<span class="line"><span style="color:#F78C6C;">WHERE</span><span style="color:#A6ACCD;"> schemaname </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">public</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">;</span></span></code></pre></div><div class="language-txt"><button title="Copy Code" class="copy"></button><span class="lang">txt</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#A6ACCD;">tablename       | size</span></span>
<span class="line"><span style="color:#A6ACCD;">----------------------+-------</span></span>
<span class="line"><span style="color:#A6ACCD;"> actor                | 72 kB</span></span>
<span class="line"><span style="color:#A6ACCD;"> film                 | 72 kB</span></span>
<span class="line"><span style="color:#A6ACCD;"> payment_p2007_02     | 72 kB</span></span>
<span class="line"><span style="color:#A6ACCD;"> payment_p2007_03     | 72 kB</span></span>
<span class="line"><span style="color:#A6ACCD;"> payment_p2007_04     | 72 kB</span></span>
<span class="line"><span style="color:#A6ACCD;"> payment_p2007_05     | 72 kB</span></span>
<span class="line"><span style="color:#A6ACCD;"> payment_p2007_06     | 72 kB</span></span>
<span class="line"><span style="color:#A6ACCD;"> payment_p2007_01     | 72 kB</span></span>
<span class="line"><span style="color:#A6ACCD;"> address              | 72 kB</span></span>
<span class="line"><span style="color:#A6ACCD;"> category             | 72 kB</span></span>
<span class="line"><span style="color:#A6ACCD;"> city                 | 72 kB</span></span>
<span class="line"><span style="color:#A6ACCD;"> country              | 72 kB</span></span>
<span class="line"><span style="color:#A6ACCD;"> customer             | 72 kB</span></span>
<span class="line"><span style="color:#A6ACCD;"> film_actor           | 72 kB</span></span>
<span class="line"><span style="color:#A6ACCD;"> film_category        | 72 kB</span></span>
<span class="line"><span style="color:#A6ACCD;"> inventory            | 72 kB</span></span>
<span class="line"><span style="color:#A6ACCD;"> language             | 72 kB</span></span>
<span class="line"><span style="color:#A6ACCD;"> rental               | 72 kB</span></span>
<span class="line"><span style="color:#A6ACCD;"> staff                | 72 kB</span></span>
<span class="line"><span style="color:#A6ACCD;"> store                | 72 kB</span></span>
<span class="line"><span style="color:#A6ACCD;"> payment              | 72 kB</span></span>
<span class="line"><span style="color:#A6ACCD;"> film_copy            | 72 kB</span></span>
<span class="line"><span style="color:#A6ACCD;"> city_copy            | 72 kB</span></span>
<span class="line"><span style="color:#A6ACCD;"> film_r               | 72 kB</span></span>
<span class="line"><span style="color:#A6ACCD;"> film_ranting_g_title | 72 kB</span></span></code></pre></div><h2 id="postgresql-索引大小" tabindex="-1">PostgreSQL 索引大小 <a class="header-anchor" href="#postgresql-索引大小" aria-label="Permalink to &quot;PostgreSQL 索引大小&quot;">​</a></h2><p>PostgreSQL <code>pg_indexes_size()</code> 函数用于获取一个指定表上的索引的大小。例如，要获取 <code>actor</code> 表的所有索引的总大小，请使用以下语句：</p><div class="language-sql"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#F78C6C;">SELECT</span></span>
<span class="line"><span style="color:#A6ACCD;">  pg_size_pretty(</span></span>
<span class="line"><span style="color:#A6ACCD;">    pg_indexes_size(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">actor</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">)</span></span>
<span class="line"><span style="color:#A6ACCD;">  );</span></span></code></pre></div><div class="language-txt"><button title="Copy Code" class="copy"></button><span class="lang">txt</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#A6ACCD;">pg_size_pretty</span></span>
<span class="line"><span style="color:#A6ACCD;">----------------</span></span>
<span class="line"><span style="color:#A6ACCD;"> 32 kB</span></span></code></pre></div><h2 id="postgresql-表空间大小" tabindex="-1">PostgreSQL 表空间大小 <a class="header-anchor" href="#postgresql-表空间大小" aria-label="Permalink to &quot;PostgreSQL 表空间大小&quot;">​</a></h2><p>PostgreSQL <code>pg_tablespace_size()</code> 函数用于获取一个指定的表空间的大小。</p><p>以下语句返回 <code>pg_default</code> 表空间的大小：</p><div class="language-sql"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#F78C6C;">SELECT</span></span>
<span class="line"><span style="color:#A6ACCD;">  pg_size_pretty (</span></span>
<span class="line"><span style="color:#A6ACCD;">      pg_tablespace_size(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">pg_default</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">)</span></span>
<span class="line"><span style="color:#A6ACCD;">  );</span></span></code></pre></div><div class="language-txt"><button title="Copy Code" class="copy"></button><span class="lang">txt</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#A6ACCD;">pg_size_pretty</span></span>
<span class="line"><span style="color:#A6ACCD;">----------------</span></span>
<span class="line"><span style="color:#A6ACCD;"> 67 MB</span></span></code></pre></div><h2 id="postgresql-值大小" tabindex="-1">PostgreSQL 值大小 <a class="header-anchor" href="#postgresql-值大小" aria-label="Permalink to &quot;PostgreSQL 值大小&quot;">​</a></h2><p>PostgreSQL <code>pg_column_size()</code> 函数用于获取指定的值占用的空间，例如：</p><p>以下语句返回一个 <code>smallint</code> 类型的值的大小：</p><div class="language-sql"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#F78C6C;">select</span><span style="color:#A6ACCD;"> pg_column_size(</span><span style="color:#F78C6C;">1</span><span style="color:#A6ACCD;">::</span><span style="color:#C792EA;">smallint</span><span style="color:#A6ACCD;">);</span></span></code></pre></div><div class="language-txt"><button title="Copy Code" class="copy"></button><span class="lang">txt</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#A6ACCD;">pg_column_size</span></span>
<span class="line"><span style="color:#A6ACCD;">----------------</span></span>
<span class="line"><span style="color:#A6ACCD;">              2</span></span></code></pre></div><p>以下语句返回一个 <code>int</code> 类型的值的大小：</p><div class="language-sql"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#F78C6C;">select</span><span style="color:#A6ACCD;"> pg_column_size(</span><span style="color:#F78C6C;">1</span><span style="color:#A6ACCD;">::</span><span style="color:#C792EA;">int</span><span style="color:#A6ACCD;">);</span></span></code></pre></div><div class="language-txt"><button title="Copy Code" class="copy"></button><span class="lang">txt</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#A6ACCD;">pg_column_size</span></span>
<span class="line"><span style="color:#A6ACCD;">----------------</span></span>
<span class="line"><span style="color:#A6ACCD;">              4</span></span></code></pre></div><p>以下语句返回一个 <code>bigint</code> 类型的值的大小：</p><div class="language-sql"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#F78C6C;">select</span><span style="color:#A6ACCD;"> pg_column_size(</span><span style="color:#F78C6C;">1</span><span style="color:#A6ACCD;">::</span><span style="color:#C792EA;">bigint</span><span style="color:#A6ACCD;">);</span></span></code></pre></div><div class="language-txt"><button title="Copy Code" class="copy"></button><span class="lang">txt</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#A6ACCD;">pg_column_size</span></span>
<span class="line"><span style="color:#A6ACCD;">----------------</span></span>
<span class="line"><span style="color:#A6ACCD;">              8</span></span></code></pre></div><h2 id="结论" tabindex="-1">结论 <a class="header-anchor" href="#结论" aria-label="Permalink to &quot;结论&quot;">​</a></h2><p>本文讲述了几个的函数来获取数据库、表、索引、表空间和值的大小。</p>`,46),o=[e];function t(c,r,C,i,y,A){return a(),n("div",null,o)}const g=s(p,[["render",t]]);export{D as __pageData,g as default};
