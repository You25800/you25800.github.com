import{_ as s,o as a,c as n,R as l}from"./chunks/framework.333b51ca.js";const d=JSON.parse('{"title":"使用 PostgreSQL RENAME COLUMN 重命名一个列","description":"","frontmatter":{},"headers":[],"relativePath":"database/postgreSQL/databaseAndTable/重命名列.md","filePath":"database/postgreSQL/databaseAndTable/重命名列.md","lastUpdated":1689061386000}'),o={name:"database/postgreSQL/databaseAndTable/重命名列.md"},p=l(`<h1 id="使用-postgresql-rename-column-重命名一个列" tabindex="-1">使用 PostgreSQL RENAME COLUMN 重命名一个列 <a class="header-anchor" href="#使用-postgresql-rename-column-重命名一个列" aria-label="Permalink to &quot;使用 PostgreSQL RENAME COLUMN 重命名一个列&quot;">​</a></h1><p>在本文中，您将了解如何使用 PostgreSQL <code>ALTER TABLE ... RENAME COLUMN</code> 语句重命名一个或者多个列。</p><p>PostgreSQL 允许您使用 <code>ALTER TABLE RENAME COLUMN</code> 语句来重命名一个已有的列。</p><h2 id="postgresql-rename-column-语法" tabindex="-1">PostgreSQL <code>RENAME COLUMN</code> 语法 <a class="header-anchor" href="#postgresql-rename-column-语法" aria-label="Permalink to &quot;PostgreSQL \`RENAME COLUMN\` 语法&quot;">​</a></h2><p>要重命名一个表中的一个列，请按照如下语法使用 <code>ALTER TABLE ... RENAME COLUMN</code> 语句：</p><div class="language-sql"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#F78C6C;">ALTER</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">TABLE</span><span style="color:#A6ACCD;"> table_name</span></span>
<span class="line"><span style="color:#A6ACCD;">RENAME [COLUMN] column_name </span><span style="color:#F78C6C;">to</span><span style="color:#A6ACCD;"> new_column_name;</span></span></code></pre></div><p>解释说明：</p><ul><li><code>table_name</code> 是要在其中重命名列的表。</li><li><code>RENAME [COLUMN] ... TO ...</code> 子句用重命名一个列。其中 <code>COLUMN</code> 关键字是可以省略的。</li><li><code>column_name</code> 是要重命名的列的名字。 <code>new_column_name</code> 是列的新名字。</li></ul><p>当您要重命名一个列时，如果有其他的数据库对象（比如<a href="./外键.html">外键</a>、视图、触发器、存储过程等）引用了此列， PostgreSQL 将自动更改那些依赖对象中的列名。</p><p>如果您输入一个不存在列名， PostgreSQL 将给出一个错误： ERROR: column “x” does not exist。</p><p>一个 <code>ALTER TABLE ... RENAME COLUMN</code> 语句只能重命名一个列。如果您想重命名多个列，请使用多个语句。</p><h2 id="postgresql-rename-column-示例" tabindex="-1">PostgreSQL <code>RENAME COLUMN</code> 示例 <a class="header-anchor" href="#postgresql-rename-column-示例" aria-label="Permalink to &quot;PostgreSQL \`RENAME COLUMN\` 示例&quot;">​</a></h2><p>这个实例演示了如何在 PostgreSQL 中重命名一个表中的一个列。</p><p>我们将在 <code>testdb</code> 数据库中创建 <code>users</code> 和 <code>user_hobbies</code> 两个表。其中， <code>users</code> 表用来存储用户的名称，性别，年龄等信息。 <code>user_hobbies</code> 表用来存储用户的业余爱好。</p><p>使用以下语句创建 <code>users</code> 表：</p><div class="language-sql"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#F78C6C;">DROP</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">TABLE</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">IF</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">EXISTS</span><span style="color:#A6ACCD;"> users;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F78C6C;">CREATE</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">TABLE</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">users</span><span style="color:#A6ACCD;"> (</span></span>
<span class="line"><span style="color:#A6ACCD;">  user_id </span><span style="color:#C792EA;">INTEGER</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">NOT NULL</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">PRIMARY KEY</span><span style="color:#A6ACCD;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F78C6C;">name</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">VARCHAR</span><span style="color:#A6ACCD;">(</span><span style="color:#F78C6C;">45</span><span style="color:#A6ACCD;">) </span><span style="color:#F78C6C;">NOT NULL</span><span style="color:#A6ACCD;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">  age </span><span style="color:#C792EA;">INTEGER</span><span style="color:#A6ACCD;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">  locked </span><span style="color:#C792EA;">BOOLEAN</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">NOT NULL</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">DEFAULT</span><span style="color:#A6ACCD;"> false,</span></span>
<span class="line"><span style="color:#A6ACCD;">  created_at </span><span style="color:#C792EA;">TIMESTAMP</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">NOT NULL</span></span>
<span class="line"><span style="color:#A6ACCD;">);</span></span></code></pre></div><p>使用以下语句创建 <code>user_hobbies</code> 表：</p><div class="language-sql"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#F78C6C;">DROP</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">TABLE</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">IF</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">EXISTS</span><span style="color:#A6ACCD;"> user_hobbies;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F78C6C;">CREATE</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">TABLE</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">user_hobbies</span><span style="color:#A6ACCD;"> (</span></span>
<span class="line"><span style="color:#A6ACCD;">  hobby_id </span><span style="color:#C792EA;">SERIAL</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">NOT NULL</span><span style="color:#A6ACCD;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">  user_id </span><span style="color:#C792EA;">INTEGER</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">NOT NULL</span><span style="color:#A6ACCD;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">  hobby </span><span style="color:#C792EA;">VARCHAR</span><span style="color:#A6ACCD;">(</span><span style="color:#F78C6C;">45</span><span style="color:#A6ACCD;">) </span><span style="color:#F78C6C;">NOT NULL</span><span style="color:#A6ACCD;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">  created_at </span><span style="color:#C792EA;">TIMESTAMP</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">NOT NULL</span><span style="color:#A6ACCD;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#C792EA;">PRIMARY KEY</span><span style="color:#A6ACCD;"> (hobby_id),</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#C792EA;">CONSTRAINT</span><span style="color:#A6ACCD;"> fk_user</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#C792EA;">FOREIGN KEY</span><span style="color:#A6ACCD;"> (user_id)</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#C792EA;">REFERENCES</span><span style="color:#A6ACCD;"> users (user_id)</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#C792EA;">ON DELETE CASCADE</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#F78C6C;">ON</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">UPDATE</span><span style="color:#A6ACCD;"> RESTRICT);</span></span></code></pre></div><p>使用 <code>\\d</code> 命令查看 <code>users</code> 表的定义：</p><div class="language-sql"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#A6ACCD;">\\d users</span></span></code></pre></div><div class="language-sql"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#F78C6C;">Table</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">public.users</span><span style="color:#89DDFF;">&quot;</span></span>
<span class="line"><span style="color:#A6ACCD;">   Column   |            </span><span style="color:#F78C6C;">Type</span><span style="color:#A6ACCD;">             | Collation | Nullable | </span><span style="color:#C792EA;">Default</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">------------+-----------------------------+-----------+----------+---------</span></span>
<span class="line"><span style="color:#A6ACCD;"> user_id    | </span><span style="color:#C792EA;">integer</span><span style="color:#A6ACCD;">                     |           | </span><span style="color:#F78C6C;">not null</span><span style="color:#A6ACCD;"> |</span></span>
<span class="line"><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">name</span><span style="color:#A6ACCD;">       | </span><span style="color:#C792EA;">character varying</span><span style="color:#A6ACCD;">(</span><span style="color:#F78C6C;">45</span><span style="color:#A6ACCD;">)       |           | </span><span style="color:#F78C6C;">not null</span><span style="color:#A6ACCD;"> |</span></span>
<span class="line"><span style="color:#A6ACCD;"> age        | </span><span style="color:#C792EA;">integer</span><span style="color:#A6ACCD;">                     |           |          |</span></span>
<span class="line"><span style="color:#A6ACCD;"> locked     | </span><span style="color:#C792EA;">boolean</span><span style="color:#A6ACCD;">                     |           | </span><span style="color:#F78C6C;">not null</span><span style="color:#A6ACCD;"> | false</span></span>
<span class="line"><span style="color:#A6ACCD;"> created_at | </span><span style="color:#C792EA;">timestamp without time zone</span><span style="color:#A6ACCD;"> |           | </span><span style="color:#F78C6C;">not null</span><span style="color:#A6ACCD;"> |</span></span>
<span class="line"><span style="color:#A6ACCD;">Indexes:</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">users_pkey</span><span style="color:#89DDFF;">&quot;</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">PRIMARY KEY</span><span style="color:#A6ACCD;">, btree (user_id)</span></span>
<span class="line"><span style="color:#A6ACCD;">Referenced </span><span style="color:#F78C6C;">by</span><span style="color:#A6ACCD;">:</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#F78C6C;">TABLE</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">user_hobbies</span><span style="color:#89DDFF;">&quot;</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">CONSTRAINT</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">fk_user</span><span style="color:#89DDFF;">&quot;</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">FOREIGN KEY</span><span style="color:#A6ACCD;"> (user_id) </span><span style="color:#C792EA;">REFERENCES</span><span style="color:#A6ACCD;"> users(user_id) </span><span style="color:#F78C6C;">ON</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">UPDATE</span><span style="color:#A6ACCD;"> RESTRICT </span><span style="color:#C792EA;">ON DELETE CASCADE</span></span></code></pre></div><p>使用 <code>\\d</code> 命令查看 <code>user_hobbies</code> 表的定义：</p><div class="language-sql"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#A6ACCD;">\\d user_hobbies</span></span></code></pre></div><div class="language-sql"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#F78C6C;">Table</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">public.user_hobbies</span><span style="color:#89DDFF;">&quot;</span></span>
<span class="line"><span style="color:#A6ACCD;">   Column   |            </span><span style="color:#F78C6C;">Type</span><span style="color:#A6ACCD;">             | Collation | Nullable |                    </span><span style="color:#C792EA;">Default</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">------------+-----------------------------+-----------+----------+------------------------------------------------</span></span>
<span class="line"><span style="color:#A6ACCD;"> hobby_id   | </span><span style="color:#C792EA;">integer</span><span style="color:#A6ACCD;">                     |           | </span><span style="color:#F78C6C;">not null</span><span style="color:#A6ACCD;"> | nextval(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">user_hobbies_hobby_id_seq</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">::regclass)</span></span>
<span class="line"><span style="color:#A6ACCD;"> user_id    | </span><span style="color:#C792EA;">integer</span><span style="color:#A6ACCD;">                     |           | </span><span style="color:#F78C6C;">not null</span><span style="color:#A6ACCD;"> |</span></span>
<span class="line"><span style="color:#A6ACCD;"> hobby      | </span><span style="color:#C792EA;">character varying</span><span style="color:#A6ACCD;">(</span><span style="color:#F78C6C;">45</span><span style="color:#A6ACCD;">)       |           | </span><span style="color:#F78C6C;">not null</span><span style="color:#A6ACCD;"> |</span></span>
<span class="line"><span style="color:#A6ACCD;"> created_at | </span><span style="color:#C792EA;">timestamp without time zone</span><span style="color:#A6ACCD;"> |           | </span><span style="color:#F78C6C;">not null</span><span style="color:#A6ACCD;"> |</span></span>
<span class="line"><span style="color:#A6ACCD;">Indexes:</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">user_hobbies_pkey</span><span style="color:#89DDFF;">&quot;</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">PRIMARY KEY</span><span style="color:#A6ACCD;">, btree (hobby_id)</span></span>
<span class="line"><span style="color:#A6ACCD;">Foreign</span><span style="color:#89DDFF;">-</span><span style="color:#F78C6C;">key</span><span style="color:#A6ACCD;"> constraints:</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">fk_user</span><span style="color:#89DDFF;">&quot;</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">FOREIGN KEY</span><span style="color:#A6ACCD;"> (user_id) </span><span style="color:#C792EA;">REFERENCES</span><span style="color:#A6ACCD;"> users(user_id) </span><span style="color:#F78C6C;">ON</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">UPDATE</span><span style="color:#A6ACCD;"> RESTRICT </span><span style="color:#C792EA;">ON DELETE CASCADE</span></span></code></pre></div><p>我们看到， <code>user_hobbies</code> 表中的外键 <code>fk_user</code> 引用了 <code>users</code> 表中的 <code>user_id</code> 列。</p><p>下面的语句用来要将 <code>users</code> 表 <code>user_id</code> 列重命名为 <code>id</code>：</p><div class="language-sql"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#F78C6C;">ALTER</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">TABLE</span><span style="color:#A6ACCD;"> users</span></span>
<span class="line"><span style="color:#A6ACCD;">RENAME COLUMN user_id </span><span style="color:#F78C6C;">TO</span><span style="color:#A6ACCD;"> id;</span></span></code></pre></div><p>由于 <code>user_hobbies</code> 表中的外键 <code>fk_user</code> 引用了 <code>users</code> 表中的 <code>user_id</code> 列，因此 PostgreSQL 自动更新了这个外键依赖的列名。</p><p>我们可以通过 <code>\\d</code> 命令查看表定义以验证 <code>user_hobbies</code> 表中外键是否被更新，如下：</p><div class="language-sql"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#A6ACCD;">\\d user_hobbies</span></span></code></pre></div><div class="language-sql"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#F78C6C;">Table</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">public.user_hobbies</span><span style="color:#89DDFF;">&quot;</span></span>
<span class="line"><span style="color:#A6ACCD;">   Column   |            </span><span style="color:#F78C6C;">Type</span><span style="color:#A6ACCD;">             | Collation | Nullable |                    </span><span style="color:#C792EA;">Default</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">------------+-----------------------------+-----------+----------+------------------------------------------------</span></span>
<span class="line"><span style="color:#A6ACCD;"> hobby_id   | </span><span style="color:#C792EA;">integer</span><span style="color:#A6ACCD;">                     |           | </span><span style="color:#F78C6C;">not null</span><span style="color:#A6ACCD;"> | nextval(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">user_hobbies_hobby_id_seq</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">::regclass)</span></span>
<span class="line"><span style="color:#A6ACCD;"> user_id    | </span><span style="color:#C792EA;">integer</span><span style="color:#A6ACCD;">                     |           | </span><span style="color:#F78C6C;">not null</span><span style="color:#A6ACCD;"> |</span></span>
<span class="line"><span style="color:#A6ACCD;"> hobby      | </span><span style="color:#C792EA;">character varying</span><span style="color:#A6ACCD;">(</span><span style="color:#F78C6C;">45</span><span style="color:#A6ACCD;">)       |           | </span><span style="color:#F78C6C;">not null</span><span style="color:#A6ACCD;"> |</span></span>
<span class="line"><span style="color:#A6ACCD;"> created_at | </span><span style="color:#C792EA;">timestamp without time zone</span><span style="color:#A6ACCD;"> |           | </span><span style="color:#F78C6C;">not null</span><span style="color:#A6ACCD;"> |</span></span>
<span class="line"><span style="color:#A6ACCD;">Indexes:</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">user_hobbies_pkey</span><span style="color:#89DDFF;">&quot;</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">PRIMARY KEY</span><span style="color:#A6ACCD;">, btree (hobby_id)</span></span>
<span class="line"><span style="color:#A6ACCD;">Foreign</span><span style="color:#89DDFF;">-</span><span style="color:#F78C6C;">key</span><span style="color:#A6ACCD;"> constraints:</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">fk_user</span><span style="color:#89DDFF;">&quot;</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">FOREIGN KEY</span><span style="color:#A6ACCD;"> (user_id) </span><span style="color:#C792EA;">REFERENCES</span><span style="color:#A6ACCD;"> users(id) </span><span style="color:#F78C6C;">ON</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">UPDATE</span><span style="color:#A6ACCD;"> RESTRICT </span><span style="color:#C792EA;">ON DELETE CASCADE</span></span></code></pre></div><p>从最后一行的 <code>users(id)</code>，我们看到了外键中依赖的列名被自动更新了。</p><h2 id="结论" tabindex="-1">结论 <a class="header-anchor" href="#结论" aria-label="Permalink to &quot;结论&quot;">​</a></h2><p>PostgreSQL <code>ALTER TABLE RENAME COLUMN</code> 语句用来重命名一个已有的列。 您还可以<a href="./重命名表.html">重命名表</a>、<a href="./重命名列.html">重命名列</a>、<a href="./删除列.html">删除列</a>、<a href="./修改列.html">修改列</a>的属性等。</p>`,34),e=[p];function t(c,C,r,A,y,i){return a(),n("div",null,e)}const E=s(o,[["render",t]]);export{d as __pageData,E as default};
