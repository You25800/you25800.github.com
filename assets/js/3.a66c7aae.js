(window.webpackJsonp=window.webpackJsonp||[]).push([[3],{281:function(s,a,t){s.exports=t.p+"assets/img/download.19a41b83.png"},282:function(s,a,t){s.exports=t.p+"assets/img/3.d3c9febe.png"},283:function(s,a,t){s.exports=t.p+"assets/img/2.36ff7570.png"},284:function(s,a,t){s.exports=t.p+"assets/img/4.a939018a.png"},285:function(s,a,t){s.exports=t.p+"assets/img/image-20220927153941132.4288f29b.png"},286:function(s,a,t){s.exports=t.p+"assets/img/image-20220927154149016.333c2d82.png"},287:function(s,a,t){s.exports=t.p+"assets/img/image-20220927154230580.1ae15dbd.png"},288:function(s,a,t){s.exports=t.p+"assets/img/image-20220927154313380.d1fbfc1c.png"},289:function(s,a,t){s.exports=t.p+"assets/img/image-20220927154437177.51c574e1.png"},290:function(s,a,t){s.exports=t.p+"assets/img/image-20220927154528494.864442e1.png"},291:function(s,a,t){s.exports=t.p+"assets/img/image-20220927154618352.41988d1c.png"},292:function(s,a,t){s.exports=t.p+"assets/img/image-20220927162802262.1d6105aa.png"},293:function(s,a,t){s.exports=t.p+"assets/img/image-20220927163303119.cd72c1c4.png"},294:function(s,a,t){s.exports=t.p+"assets/img/image-20220927163357772.9578d4f5.png"},295:function(s,a,t){s.exports=t.p+"assets/img/image-20220927163743685.f0134f09.png"},296:function(s,a,t){s.exports=t.p+"assets/img/image-20220927163905182.eff6ff22.png"},297:function(s,a,t){s.exports=t.p+"assets/img/image-20220927163951266.7aed088c.png"},298:function(s,a,t){s.exports=t.p+"assets/img/image-20220927164758235.b8181237.png"},299:function(s,a,t){s.exports=t.p+"assets/img/image-20220927165222266.05275cd2.png"},320:function(s,a,t){"use strict";t.r(a);var e=t(13),n=Object(e.a)({},(function(){var s=this,a=s._self._c;return a("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[a("h1",{attrs:{id:"elasticsearch-安装-使用"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#elasticsearch-安装-使用"}},[s._v("#")]),s._v(" "),a("strong",[s._v("Elasticsearch")]),s._v(" "),a("strong",[s._v("安装")]),s._v(" "),a("strong",[s._v("&")]),s._v(" "),a("strong",[s._v("使用")])]),s._v(" "),a("p",[s._v("本章是根据尚硅谷教学视频编写 "),a("a",{attrs:{href:"https://www.bilibili.com/video/BV1hh411D7sb/?spm_id_from=333.337.search-card.all.click&vd_source=c2c3977953334eb68fd28f89418ceaa6",target:"_blank",rel:"noopener noreferrer"}},[s._v("https://www.bilibili.com/video/BV1hh411D7sb/?spm_id_from=333.337.search-card.all.click&vd_source=c2c3977953334eb68fd28f89418ceaa6"),a("OutboundLink")],1)]),s._v(" "),a("h2",{attrs:{id:"下载软件"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#下载软件"}},[s._v("#")]),s._v(" "),a("strong",[s._v("下载软件")])]),s._v(" "),a("p",[s._v("Elasticsearch 的官方地址：https://www.elastic.co/cn/")]),s._v(" "),a("p",[s._v("Elasticsearch 最新的版本是 8.2.3（截止 2022.06.15），我们选择略早的 8.1.0 版本")]),s._v(" "),a("p",[s._v("下载地址：https://www.elastic.co/cn/downloads/past-releases#elasticsearch")]),s._v(" "),a("img",{staticStyle:{zoom:"33%"},attrs:{src:t(281),alt:"image-20220927135705960"}}),s._v(" "),a("p",[s._v("可以根据情况自行选择不同操作系统的版本。")]),s._v(" "),a("h2",{attrs:{id:"安装软件"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#安装软件"}},[s._v("#")]),s._v(" 安装软件")]),s._v(" "),a("p",[s._v("针对新版ES软件的特性与应用，所以采用Linux集群配置")]),s._v(" "),a("ol",[a("li",[a("p",[s._v("集群规划")]),s._v(" "),a("p",[s._v("为了演示软件的使用，我们这里准备三台 linux 虚拟机，用于配置 Elasticsearch 集群。")]),s._v(" "),a("p",[s._v("启动集群后，每台虚拟机的进程如下：")]),s._v(" "),a("table",[a("thead",[a("tr",[a("th",[s._v("主机名")]),s._v(" "),a("th",[s._v("linux1")]),s._v(" "),a("th",[s._v("linux2")]),s._v(" "),a("th",[s._v("linux3")])])]),s._v(" "),a("tbody",[a("tr",[a("td",[s._v("进程名")]),s._v(" "),a("td",[s._v("Elasticsearch(es-node-1)")]),s._v(" "),a("td",[s._v("Elasticsearch(es-node-2)")]),s._v(" "),a("td",[s._v("Elasticsearch(es-node-3)")])])])]),s._v(" "),a("p",[s._v("Linux 系统环境配置请参考之前课程内容。这里我们给三台虚拟机搭建 ES 集群，集群")]),s._v(" "),a("p",[s._v("中-节点名称依次为 es-node-1，es-node-2，es-node-3")])]),s._v(" "),a("li",[a("p",[s._v("将压缩包 elasticsearch-8.1.0-linux-x86_64.tar.gz 上传到虚拟机中")]),s._v(" "),a("p",[s._v("解压缩文件到自定义路径，笔者解压路径为：/opt/module,解压后，软件路径为：")]),s._v(" "),a("p",[s._v("/opt/module/elasticsearch-8.1.0")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 切换目录")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("cd")]),s._v(" software\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 解压缩")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("tar")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-zxvf")]),s._v(" elasticsearch-8.1.0-linux-x86_64.tar.gz "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-C")]),s._v(" /opt/module\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br")])]),a("p",[s._v("解压后的 Elasticsearch 的目录结构如下")]),s._v(" "),a("img",{staticStyle:{zoom:"100%"},attrs:{src:"/elasticsearch/1.png",alt:"image-20220927135705960"}}),s._v(" "),a("table",[a("thead",[a("tr",[a("th",[s._v("目录")]),s._v(" "),a("th",[s._v("含义")])])]),s._v(" "),a("tbody",[a("tr",[a("td",[s._v("bin")]),s._v(" "),a("td",[s._v("可执行脚本目录")])]),s._v(" "),a("tr",[a("td",[s._v("config")]),s._v(" "),a("td",[s._v("配置目录")])]),s._v(" "),a("tr",[a("td",[s._v("jdk")]),s._v(" "),a("td",[s._v("内置JDK目录")])]),s._v(" "),a("tr",[a("td",[s._v("lib")]),s._v(" "),a("td",[s._v("类库")])]),s._v(" "),a("tr",[a("td",[s._v("logs")]),s._v(" "),a("td",[s._v("日志目录")])]),s._v(" "),a("tr",[a("td",[s._v("modules")]),s._v(" "),a("td",[s._v("模块目录")])]),s._v(" "),a("tr",[a("td",[s._v("plugins")]),s._v(" "),a("td",[s._v("插件目录")])])])])]),s._v(" "),a("li",[a("p",[s._v("当前安装 ES 版本为 8.1.0，自带 JDK，所以当前 Linux 虚拟机节点无需配置 Java 环境")])]),s._v(" "),a("li",[a("p",[s._v("创建linux新用户es，数据文件，证书目录，并修改Elasticsearch文件拥有者")]),s._v(" "),a("p",[a("code",[s._v("由于es不允许root用户操作，所以需要创建新用户")])]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 新增es用户")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("useradd")]),s._v(" es\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 为es用户设置密码")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("passwd")]),s._v(" es\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 创建数据文件目录")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("mkdir")]),s._v(" /opt/module/elasticsearch-8.1.0/data\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 创建证书目录")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("mkdir")]),s._v(" /opt/module/elasticsearch-8.1.0/config/certs\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 切换目录")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("cd")]),s._v(" /opt/module/elasticsearch-8.1.0\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 修改文件拥有者")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("chown")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-R")]),s._v(" es:es /opt/module/elasticsearch-8.1.0\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br")])])]),s._v(" "),a("li",[a("p",[s._v("在第一台服务器节点es-node-1设置集群多节点通信密钥")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 切换用户")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("su")]),s._v(" es\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 签发 ca 证书，过程中需按两次回车键")]),s._v("\nbin/elasticsearch-certutil ca\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 用 ca 证书签发节点证书，过程中需按三次回车键")]),s._v("\nbin/elasticsearch-certutil cert "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--ca")]),s._v(" elastic-stack-ca.p12\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 将生成的证书文件移动到 config/certs 目录中")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("mv")]),s._v(" elastic-stack-ca.p12 elastic-certificates.p12 config/certs\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br")])])]),s._v(" "),a("li",[a("p",[s._v("在第一台服务器节点es-node-1设置集群多节点HTTP证书")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 签发 Https 证书")]),s._v("\nbin/elasticsearch-certutil http\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 以下是每次要求输入时，需要输入的内容")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br")])]),a("img",{staticStyle:{zoom:"66%"},attrs:{src:t(282),alt:"image-20220927135705960"}}),s._v(" "),a("img",{staticStyle:{zoom:"66%"},attrs:{src:t(283),alt:"image-20220927135705960"}}),s._v(" "),a("p",[s._v("指定证书路径")]),s._v(" "),a("img",{staticStyle:{zoom:"66%"},attrs:{src:t(284),alt:"image-20220927135705960"}}),s._v(" "),a("p",[s._v("无需输入密码")]),s._v(" "),a("img",{staticStyle:{zoom:"67%"},attrs:{src:t(285),alt:"image-20220927153941132"}}),s._v(" "),a("p",[s._v("设置证书失效时间")]),s._v(" "),a("img",{staticStyle:{zoom:"67%"},attrs:{src:t(286),alt:"image-20220927154149016"}}),s._v(" "),a("p",[s._v("无需每个节点配置证书")]),s._v(" "),a("img",{staticStyle:{zoom:"67%"},attrs:{src:t(287),alt:"image-20220927154230580"}}),s._v(" "),a("p",[s._v("输出连接到第一个节点的所有主机名")]),s._v(" "),a("img",{staticStyle:{zoom:"67%"},attrs:{src:t(288),alt:"image-20220927154313380"}}),s._v(" "),a("p",[s._v("输出连接到第一个基点的所有主机 "),a("strong",[s._v("IP")]),s._v(" 地址")]),s._v(" "),a("img",{staticStyle:{zoom:"67%"},attrs:{src:t(289),alt:"image-20220927154437177"}}),s._v(" "),a("p",[s._v("不改变证书选项配置")]),s._v(" "),a("img",{staticStyle:{zoom:"67%"},attrs:{src:t(290),alt:"image-20220927154528494"}}),s._v(" "),a("p",[s._v("不给证书加密，按键输入两次回车")]),s._v(" "),a("img",{staticStyle:{zoom:"67%"},attrs:{src:t(291),alt:"image-20220927154618352"}}),s._v(" "),a("p",[s._v("解压刚刚生成的zip包")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 解压文件")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("unzip")]),s._v(" elasticsearch-ssl-http.zip\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br")])]),a("p",[s._v("将解压后的证书文件移动到config/certs目录中")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 移动文件")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("mv")]),s._v(" elasticsearch/http.p12 kibana/elasticsearch-ca.pem config/certs\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br")])])]),s._v(" "),a("li",[a("p",[s._v("修改住配置文件：config/elasticsearch.yml")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 设置 ES 集群名称")]),s._v("\ncluster.name: es-cluster\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 设置集群中当前节点名称")]),s._v("\nnode.name: es-node-1\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 设置数据，日志文件路径")]),s._v("\npath.data: /opt/module/elasticsearch-8.1.0/data\npath.logs: /opt/module/elasticsearch-8.1.0/log\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 设置网络访问节点")]),s._v("\nnetwork.host: linux1\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 设置网络访问端口")]),s._v("\nhttp.port: "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("9200")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 初始节点")]),s._v("\ndiscovery.seed_hosts: "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"linux1"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 安全认证")]),s._v("\nxpack.security.enabled: "),a("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("true")]),s._v("\nxpack.security.enrollment.enabled: "),a("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("true")]),s._v("\nxpack.security.http.ssl:\n enabled: "),a("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("true")]),s._v("\n keystore.path: /opt/module/elasticsearch-8.1.0/config/certs/http.p12\n truststore.path: /opt/module/elasticsearch-8.1.0/config/certs/http.p12\nxpack.security.transport.ssl:\n enabled: "),a("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("true")]),s._v("\n verification_mode: certificate\n keystore.path:\n/opt/module/elasticsearch-8.1.0/config/certs/elastic-certificates.p12\n truststore.path:\n/opt/module/elasticsearch-8.1.0/config/certs/elastic-certificates.p12\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 此处需注意，es-node-1 为上面配置的节点名称")]),s._v("\ncluster.initial_master_nodes: "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"es-node-1"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\nhttp.host: "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("_local_, _site_"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\ningest.geoip.downloader.enabled: "),a("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("false")]),s._v("\nxpack.security.http.ssl.client_authentication: none\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br"),a("span",{staticClass:"line-number"},[s._v("23")]),a("br"),a("span",{staticClass:"line-number"},[s._v("24")]),a("br"),a("span",{staticClass:"line-number"},[s._v("25")]),a("br"),a("span",{staticClass:"line-number"},[s._v("26")]),a("br"),a("span",{staticClass:"line-number"},[s._v("27")]),a("br"),a("span",{staticClass:"line-number"},[s._v("28")]),a("br"),a("span",{staticClass:"line-number"},[s._v("29")]),a("br"),a("span",{staticClass:"line-number"},[s._v("30")]),a("br"),a("span",{staticClass:"line-number"},[s._v("31")]),a("br"),a("span",{staticClass:"line-number"},[s._v("32")]),a("br")])])]),s._v(" "),a("li",[a("p",[s._v("启动ES软件")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 启动ES软件")]),s._v("\nbin/elasticsearch\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br")])])])]),s._v(" "),a("p",[s._v("第一次成功启动后，会显示密码，请记住，访问时需要。只有第一次才有！")]),s._v(" "),a("img",{staticStyle:{zoom:"67%"},attrs:{src:t(292),alt:"image-20220927162802262"}}),s._v(" "),a("p",[a("font",{attrs:{color:"red"}},[s._v("上面图形内容因为涉及到多节点集群配置以及kibana配置，所以极其重要！！！")])],1),s._v(" "),a("p",[a("font",{attrs:{color:"red"}},[s._v("如果没有出现上面图片，出现下面图片也可以按照指示方式进行配置。")])],1),s._v(" "),a("img",{staticStyle:{zoom:"50%"},attrs:{src:t(293),alt:"image-20220927163303119"}}),s._v(" "),a("p",[a("img",{attrs:{src:t(294),alt:"image-20220927163357772"}})]),s._v(" "),a("p",[s._v("注意：9300端口为Elasticsearch集群间组件的通信端口，9200端口为浏览器访问的http协议RESTFUL端口。")]),s._v(" "),a("ol",{attrs:{start:"9"}},[a("li",[a("p",[s._v("访问服务器节点https://虚拟机地址:9200")]),s._v(" "),a("p",[s._v("因为配置了安全协议，所以使用https协议进行访问，但由于证书是自己生成的，并不可靠，所以会有安全提示")]),s._v(" "),a("img",{staticStyle:{zoom:"50%"},attrs:{src:t(295),alt:"image-20220927163743685"}}),s._v(" "),a("p",[s._v("选择继续或在该页面直接敲thisisunsafe即可")]),s._v(" "),a("img",{staticStyle:{zoom:"50%"},attrs:{src:t(296),alt:"image-20220927163905182"}}),s._v(" "),a("p",[s._v("输入账号，密码登陆即可")]),s._v(" "),a("img",{staticStyle:{zoom:"50%"},attrs:{src:t(297),alt:"image-20220927163951266"}})]),s._v(" "),a("li",[a("p",[s._v("修改集群中的其他节点配置文件：config/elasticsearch.yml")]),s._v(" "),a("p",[s._v("linux2: 证书直接拷贝，其他步骤完全相同，配置文件中修改如下内容即可")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 设置节点名称")]),s._v("\nnode.name: es-node-2\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 设置网络访问主机")]),s._v("\nnetwork.host: linux2\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br")])]),a("p",[s._v("linux3:证书直接拷贝，其他步骤完全相同，配置文件中修改如下内容即可")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 设置节点名称")]),s._v("\nnode.name: es-node-3\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 设置网络访问主机")]),s._v("\nnetwork.host: linux3\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br")])])]),s._v(" "),a("li",[a("p",[s._v("依次启动集群的三台服务器节点, "),a("font",{attrs:{color:"red"}},[s._v("不要忘记切换用户后再启动")])],1),s._v(" "),a("p",[s._v("Linux1、linux2、linux3:")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 后台启动服务")]),s._v("\nbin/elasticsearch "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-d")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br")])])])]),s._v(" "),a("h2",{attrs:{id:"问题解决"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#问题解决"}},[s._v("#")]),s._v(" 问题解决")]),s._v(" "),a("ul",[a("li",[a("p",[s._v("Elasticsearch 是使用 java 开发的，8.1 版本的 ES 需要 JDK17 及以上版本。默认安装包 中带有 JDK 环境，如果系统配置 ES_JAVA_HOME 环境变量，那么会采用系统配置的 JDK。如果没有配置该环境变量，ES 会使用自带捆绑的 JDK。虽然自带的 JDK 是 ES 软件推荐的 Java 版本，但一般建议使用系统配置的 JDK。")])]),s._v(" "),a("li",[a("p",[s._v("Windows 环境中出现下面的错误信息，是因为开启了 SSL 认证：")]),s._v(" "),a("img",{staticStyle:{zoom:"50%"},attrs:{src:t(298),alt:"image-20220927164758235"}}),s._v(" "),a("p",[s._v("修改 config/elasticsearch.yml 文件，将 enabled 的值修改为 false")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Enable encryption for HTTP API client connections, such as Kibana, Logstash,")]),s._v("\nand Agents\nxpack.security.http.ssl:\n enabled: "),a("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("false")]),s._v("\n keystore.path: certs/http.p12\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br")])])]),s._v(" "),a("li",[a("p",[s._v("启动成功后，如果访问 localhost:9200 地址后，弹出登录窗口")]),s._v(" "),a("p",[s._v("第一次启动时，因为开启了密码验证模式，在启动窗口中会显示输入账号和密码。如果 没有注意到或没有找到账号密码，可以设置免密登录：")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Enable security features")]),s._v("\nxpack.security.enabled: "),a("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("false")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br")])])]),s._v(" "),a("li",[a("p",[s._v("双击启动窗口闪退，通过路径访问追踪错误，如果是“空间不足”，请修改config/jvm.options 配置文件")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 设置 JVM 初始内存为 1G。此值可以设置与-Xmx 相同，以避免每次垃圾回收完成后 JVM 重新分配")]),s._v("\n内存\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Xms represents the initial size of total heap space")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 设置 JVM 最大可用内存为 1G")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Xmx represents the maximum size of total heap space")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-Xms4g")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-Xmx4g")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br")])])]),s._v(" "),a("li",[a("p",[s._v("启动后，如果密码忘记了，怎么办？可以采用指令重置密码")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 使用 es 用户，执行指令，重置 elastic 用户密码")]),s._v("\nbin/elasticsearch-reset-password "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-u")]),s._v(" elastic\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br")])]),a("img",{staticStyle:{zoom:"50%"},attrs:{src:t(299),alt:"image-20220927165222266"}}),s._v(" "),a("p",[s._v("如果只启动单一节点，此操作可能会失败，至少启动 2 个节点，测试成功")])])])])}),[],!1,null,null,null);a.default=n.exports}}]);