import{_ as s,o as a,c as n,R as l}from"./chunks/framework.318fa179.js";const u=JSON.parse('{"title":"Sakila 数据库中的存储过程","description":"","frontmatter":{},"headers":[],"relativePath":"database/sakila/存储过程.md","filePath":"database/sakila/存储过程.md","lastUpdated":1690270507000}'),e={name:"database/sakila/存储过程.md"},o=l(`<h1 id="sakila-数据库中的存储过程" tabindex="-1">Sakila 数据库中的存储过程 <a class="header-anchor" href="#sakila-数据库中的存储过程" aria-label="Permalink to &quot;Sakila 数据库中的存储过程&quot;">​</a></h1><p>本文整理了 Sakila 数据库中定义的 3 个存储过程及每个存储过程的用法。</p><p>Sakila 数据库中共定义了 3 个存储过程。</p><h2 id="film-in-stock" tabindex="-1">film_in_stock <a class="header-anchor" href="#film-in-stock" aria-label="Permalink to &quot;film\\_in\\_stock&quot;">​</a></h2><p><code>film_in_stock</code> 存储过程确定一个给定的影片在给定的商店是否有库存。</p><h3 id="参数" tabindex="-1">参数 <a class="header-anchor" href="#参数" aria-label="Permalink to &quot;参数&quot;">​</a></h3><ul><li><p><code>p_film_id</code></p><p>要检查的影片的 ID，来自 <code>film</code> 表的 <code>film_id</code> 字段。</p></li><li><p><code>p_store_id</code></p><p>要检查的商店的 ID，来自 <code>store</code> 表的 <code>store_id</code> 字段。</p></li><li><p><code>p_film_count</code></p><p><code>OUT</code> 返回库存影片拷贝数的参数。</p></li></ul><h3 id="返回值" tabindex="-1">返回值 <a class="header-anchor" href="#返回值" aria-label="Permalink to &quot;返回值&quot;">​</a></h3><p>此过程生成库存影片副本的库存 ID 编号表，并返回（在 <code>p_film_count</code> 参数中）指示该表中的行数。</p><h3 id="示例用法" tabindex="-1">示例用法 <a class="header-anchor" href="#示例用法" aria-label="Permalink to &quot;示例用法&quot;">​</a></h3><div class="language-sql"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#F78C6C;">CALL</span><span style="color:#A6ACCD;"> film_in_stock(</span><span style="color:#F78C6C;">1</span><span style="color:#A6ACCD;">,</span><span style="color:#F78C6C;">1</span><span style="color:#A6ACCD;">,@count);</span></span></code></pre></div><div class="language-txt"><button title="Copy Code" class="copy"></button><span class="lang">txt</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#A6ACCD;">+--------------+</span></span>
<span class="line"><span style="color:#A6ACCD;">| inventory_id |</span></span>
<span class="line"><span style="color:#A6ACCD;">+--------------+</span></span>
<span class="line"><span style="color:#A6ACCD;">|            1 |</span></span>
<span class="line"><span style="color:#A6ACCD;">|            2 |</span></span>
<span class="line"><span style="color:#A6ACCD;">|            3 |</span></span>
<span class="line"><span style="color:#A6ACCD;">|            4 |</span></span>
<span class="line"><span style="color:#A6ACCD;">+--------------+</span></span>
<span class="line"><span style="color:#A6ACCD;">4 rows in set (0.01 sec)</span></span>
<span class="line"><span style="color:#A6ACCD;"></span></span>
<span class="line"><span style="color:#A6ACCD;">Query OK, 1 row affected (0.01 sec)</span></span></code></pre></div><div class="language-sql"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#F78C6C;">SELECT</span><span style="color:#A6ACCD;"> @count;</span></span></code></pre></div><div class="language-txt"><button title="Copy Code" class="copy"></button><span class="lang">txt</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#A6ACCD;">+--------+</span></span>
<span class="line"><span style="color:#A6ACCD;">| @count |</span></span>
<span class="line"><span style="color:#A6ACCD;">+--------+</span></span>
<span class="line"><span style="color:#A6ACCD;">|      4 |</span></span>
<span class="line"><span style="color:#A6ACCD;">+--------+</span></span>
<span class="line"><span style="color:#A6ACCD;">1 row in set (0.00 sec)</span></span></code></pre></div><h2 id="film-not-in-stock" tabindex="-1">film_not_in_stock <a class="header-anchor" href="#film-not-in-stock" aria-label="Permalink to &quot;film\\_not\\_in\\_stock&quot;">​</a></h2><p><code>film_not_in_stock</code> 存储过程确定在给定的商店里一个给定的影片的任何拷贝是否没有库存（租出去）。</p><h3 id="参数-1" tabindex="-1">参数 <a class="header-anchor" href="#参数-1" aria-label="Permalink to &quot;参数&quot;">​</a></h3><ul><li><p><code>p_film_id</code></p><p>要检查的影片的 ID，来自 <code>film</code> 表的 <code>film_id</code> 字段。</p></li><li><p><code>p_store_id</code></p><p>要检查的商店的 ID，来自 <code>store</code> 表的 <code>store_id</code> 字段。</p></li><li><p><code>p_film_count</code></p><p>一个<code>OUT</code> 参数，返回没有库存的影片拷贝数。</p></li></ul><h3 id="返回值-1" tabindex="-1">返回值 <a class="header-anchor" href="#返回值-1" aria-label="Permalink to &quot;返回值&quot;">​</a></h3><p>此过程为没有库存的影片副本生成一个库存 ID 列表，并返回（在 <code>p_film_count</code> 参数中）指示该表中的行数。</p><h3 id="示例用法-1" tabindex="-1">示例用法 <a class="header-anchor" href="#示例用法-1" aria-label="Permalink to &quot;示例用法&quot;">​</a></h3><div class="language-sql"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#F78C6C;">CALL</span><span style="color:#A6ACCD;"> film_not_in_stock(</span><span style="color:#F78C6C;">2</span><span style="color:#A6ACCD;">, </span><span style="color:#F78C6C;">2</span><span style="color:#A6ACCD;">, @count);</span></span></code></pre></div><p>\`\`\`output\` +————–+ | inventory_id | +————–+ | 9 | +————–+ 1 row in set (0.01 sec)</p><p>Query OK, 1 row affected (0.01 sec)</p><div class="language-sql"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#A6ACCD;">mysql</span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">SELECT</span><span style="color:#A6ACCD;"> @count;</span></span></code></pre></div><div class="language-txt"><button title="Copy Code" class="copy"></button><span class="lang">txt</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#A6ACCD;">+--------+</span></span>
<span class="line"><span style="color:#A6ACCD;">| @count |</span></span>
<span class="line"><span style="color:#A6ACCD;">+--------+</span></span>
<span class="line"><span style="color:#A6ACCD;">|      1 |</span></span>
<span class="line"><span style="color:#A6ACCD;">+--------+</span></span>
<span class="line"><span style="color:#A6ACCD;">1 row in set (0.00 sec)</span></span></code></pre></div><h2 id="rewards-report" tabindex="-1">rewards_report <a class="header-anchor" href="#rewards-report" aria-label="Permalink to &quot;rewards\\_report&quot;">​</a></h2><p><code>rewards_report</code> 存储过程会生成一个由参数指定的上个月的优质客户的列表。</p><h3 id="参数-2" tabindex="-1">参数 <a class="header-anchor" href="#参数-2" aria-label="Permalink to &quot;参数&quot;">​</a></h3><ul><li><p><code>min_monthly_purchases</code></p><p>客户在上个月需要进行的最低购买或租赁次数才能获得资格。</p></li><li><p><code>min_dollar_amount_purchased</code></p><p>客户在上个月需要花费的最低金额才能获得资格。</p></li><li><p><code>count_rewardees</code></p><p><code>OUT</code> 返回满足指定资格的客户计数的参数。</p></li></ul><h3 id="返回值-2" tabindex="-1">返回值 <a class="header-anchor" href="#返回值-2" aria-label="Permalink to &quot;返回值&quot;">​</a></h3><p>此过程会生成符合指定资格的客户表。该表的结构与 <a href="./客户表.html"><code>customer</code></a> 表相同。该过程还返回（在 <code>count_rewardees</code> 参数中）该表中的行数。</p><h3 id="示例用法-2" tabindex="-1">示例用法 <a class="header-anchor" href="#示例用法-2" aria-label="Permalink to &quot;示例用法&quot;">​</a></h3><div class="language-sql"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#F78C6C;">CALL</span><span style="color:#A6ACCD;"> rewards_report(</span><span style="color:#F78C6C;">7</span><span style="color:#A6ACCD;">, </span><span style="color:#F78C6C;">20</span><span style="color:#A6ACCD;">.</span><span style="color:#F78C6C;">00</span><span style="color:#A6ACCD;">, @count);</span></span></code></pre></div><div class="language-txt"><button title="Copy Code" class="copy"></button><span class="lang">txt</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#A6ACCD;">...</span></span>
<span class="line"><span style="color:#A6ACCD;">| 598         | 1        | WADE        | DELVALLE     | WADE.DELVALLE@sakilacustomer.org         | 604        | 1      | 2006-02-24 10:48:30 | 2006-02-15 04:57:20 |</span></span>
<span class="line"><span style="color:#A6ACCD;">| 599         | 2        | AUSTIN      | CINTRON      | AUSTIN.CINTRON@sakilacustomer.org        | 605        | 1      | 2006-02-24 10:48:30 | 2006-02-15 04:57:20 |</span></span>
<span class="line"><span style="color:#A6ACCD;">...</span></span>
<span class="line"><span style="color:#A6ACCD;"></span></span>
<span class="line"><span style="color:#A6ACCD;">42 rows in set (0.11 sec)</span></span>
<span class="line"><span style="color:#A6ACCD;"></span></span>
<span class="line"><span style="color:#A6ACCD;">Query OK, 0 rows affected (0.67 sec)</span></span></code></pre></div><div class="language-sql"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#F78C6C;">SELECT</span><span style="color:#A6ACCD;"> @count;</span></span></code></pre></div><div class="language-txt"><button title="Copy Code" class="copy"></button><span class="lang">txt</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#A6ACCD;">+--------+</span></span>
<span class="line"><span style="color:#A6ACCD;">| @count |</span></span>
<span class="line"><span style="color:#A6ACCD;">+--------+</span></span>
<span class="line"><span style="color:#A6ACCD;">|     42 |</span></span>
<span class="line"><span style="color:#A6ACCD;">+--------+</span></span>
<span class="line"><span style="color:#A6ACCD;">1 row in set (0.00 sec)</span></span></code></pre></div>`,37),p=[o];function t(c,i,r,d,C,A){return a(),n("div",null,p)}const y=s(e,[["render",t]]);export{u as __pageData,y as default};
